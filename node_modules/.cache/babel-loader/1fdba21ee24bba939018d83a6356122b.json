{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\NodeProjects\\\\TestMiniApp\\\\src\\\\Tracker.js\";\nimport React from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './css/Tracker.css';\nimport { Panel, PanelHeader, View, Epic, Tabbar, TabbarItem, Div } from '@vkontakte/vkui';\nimport Icon28Truck from './icons/Icon28Truck.js';\nimport Icon28Clock from './icons/Icon28Clock.js';\n\nclass Tracker extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.back = () => {\n      if (this.state.popout !== null) {\n        this.setState({\n          popout: null\n        });\n        window.history.pushState({\n          pop: 'popout'\n        }, 'Title');\n        return;\n      }\n\n      let _this$state = this.state,\n          activePanel = _this$state.activePanel,\n          activeStory = _this$state.activeStory,\n          history = _this$state.history;\n      let history_ = history[activeStory];\n\n      if (history_.length === 1) {\n        bridge.send('VKWebAppClose', {\n          status: 'success'\n        });\n      } else if (history_.length > 1) {\n        history_.pop();\n        activePanel = history_[history_.length - 1];\n        this.setState({\n          activePanel,\n          history\n        });\n      }\n    };\n\n    this.state = {\n      popout: null,\n      history: {\n        add: ['add'],\n        history: ['history']\n      },\n      activePanel: {\n        add: 'add',\n        history: 'history'\n      },\n      activeStory: 'add'\n    };\n    this.componentDidMount = this.componentDidMount.bind(this);\n    this.back = this.back.bind(this);\n    this.go = this.go.bind(this);\n    this.onStoryChange = this.onStoryChange.bind(this);\n  }\n\n  async componentDidMount() {\n    bridge.send('VKWebAppInit');\n    window.addEventListener('popstate', e => {\n      e.preventDefault();\n      this.back(e);\n    });\n    bridge.subscribe(async ({\n      detail: {\n        type,\n        data\n      }\n    }) => {\n      if (type !== undefined) console.log(type, data);\n\n      if (type === 'VKWebAppUpdateConfig') {\n        const schemeAttribute = document.createAttribute('scheme');\n        schemeAttribute.value = data.scheme ? data.scheme : 'bright_light';\n        document.body.attributes.setNamedItem(schemeAttribute);\n      }\n    });\n  }\n\n  go(panel) {\n    let _this$state2 = this.state,\n        activeStory = _this$state2.activeStory,\n        history = _this$state2.history;\n    let history_ = history[activeStory];\n\n    if (history_[history_.length - 1] !== panel) {\n      history_.push(panel);\n      window.history.pushState({\n        activePanel: panel\n      }, 'Title');\n      this.setState({\n        activePanel: panel,\n        history\n      });\n    }\n  }\n\n  onStoryChange(e) {\n    this.setState({\n      activeStory: e.currentTarget.dataset.story\n    });\n  }\n\n  render() {\n    return React.createElement(Epic, {\n      activeStory: this.state.activeStory,\n      tabbar: React.createElement(Tabbar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, React.createElement(TabbarItem, {\n        onClick: this.onStoryChange,\n        selected: this.state.activeStory === 'add',\n        \"data-story\": \"add\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(Icon28Truck, {\n        active: this.state.activeStory === 'add',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      })), React.createElement(TabbarItem, {\n        onClick: this.onStoryChange,\n        selected: this.state.activeStory === 'history',\n        \"data-story\": \"history\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, React.createElement(Icon28Clock, {\n        active: this.state.activeStory === 'history',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }))),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(View, {\n      id: \"add\",\n      activePanel: this.state.activePanel.add,\n      popout: this.state.popout,\n      history: this.state.history.add,\n      onSwipeBack: this.back,\n      separator: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(Panel, {\n      id: \"add\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(PanelHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"\\u041E\\u0442\\u0441\\u043B\\u0435\\u0436\\u0438\\u0432\\u0430\\u043D\\u0438\\u0435\"))), React.createElement(View, {\n      id: \"history\",\n      activePanel: this.state.activePanel.history,\n      popout: this.state.popout,\n      history: this.state.history.history,\n      onSwipeBack: this.back,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(Panel, {\n      id: \"history\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(PanelHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\"))));\n  }\n\n}\n\nexport default Tracker;","map":{"version":3,"sources":["C:/Users/Admin/NodeProjects/TestMiniApp/src/Tracker.js"],"names":["React","bridge","Panel","PanelHeader","View","Epic","Tabbar","TabbarItem","Div","Icon28Truck","Icon28Clock","Tracker","Component","constructor","props","back","state","popout","setState","window","history","pushState","pop","activePanel","activeStory","history_","length","send","status","add","componentDidMount","bind","go","onStoryChange","addEventListener","e","preventDefault","subscribe","detail","type","data","undefined","console","log","schemeAttribute","document","createAttribute","value","scheme","body","attributes","setNamedItem","panel","push","currentTarget","dataset","story","render"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAO,+BAAP;AACA,OAAO,mBAAP;AAEA,SAASC,KAAT,EAAgBC,WAAhB,EAA6BC,IAA7B,EAAmCC,IAAnC,EAAyCC,MAAzC,EAAiDC,UAAjD,EAA6DC,GAA7D,QAAwE,iBAAxE;AAEA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,OAAOC,WAAP,MAAwB,wBAAxB;;AAEA,MAAMC,OAAN,SAAsBX,KAAK,CAACY,SAA5B,CAAsC;AAElCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SAwCnBC,IAxCmB,GAwCZ,MAAM;AACT,UAAG,KAAKC,KAAL,CAAWC,MAAX,KAAsB,IAAzB,EAA8B;AAC1B,aAAKC,QAAL,CAAc;AAAED,UAAAA,MAAM,EAAE;AAAV,SAAd;AACAE,QAAAA,MAAM,CAACC,OAAP,CAAeC,SAAf,CAAyB;AAAEC,UAAAA,GAAG,EAAE;AAAP,SAAzB,EAA4C,OAA5C;AACA;AACH;;AALQ,wBAMmC,KAAKN,KANxC;AAAA,UAMHO,WANG,eAMHA,WANG;AAAA,UAMUC,WANV,eAMUA,WANV;AAAA,UAMuBJ,OANvB,eAMuBA,OANvB;AAOT,UAAIK,QAAQ,GAAGL,OAAO,CAACI,WAAD,CAAtB;;AACA,UAAGC,QAAQ,CAACC,MAAT,KAAoB,CAAvB,EAA0B;AACtBzB,QAAAA,MAAM,CAAC0B,IAAP,CAAY,eAAZ,EAA6B;AAAEC,UAAAA,MAAM,EAAE;AAAV,SAA7B;AACH,OAFD,MAEO,IAAIH,QAAQ,CAACC,MAAT,GAAkB,CAAtB,EAAyB;AAC5BD,QAAAA,QAAQ,CAACH,GAAT;AACAC,QAAAA,WAAW,GAAGE,QAAQ,CAACA,QAAQ,CAACC,MAAT,GAAkB,CAAnB,CAAtB;AACA,aAAKR,QAAL,CAAc;AAAEK,UAAAA,WAAF;AAAeH,UAAAA;AAAf,SAAd;AACH;AACJ,KAvDkB;;AAGf,SAAKJ,KAAL,GAAa;AACTC,MAAAA,MAAM,EAAE,IADC;AAETG,MAAAA,OAAO,EAAE;AACLS,QAAAA,GAAG,EAAE,CAAE,KAAF,CADA;AAELT,QAAAA,OAAO,EAAE,CAAE,SAAF;AAFJ,OAFA;AAMTG,MAAAA,WAAW,EAAE;AACTM,QAAAA,GAAG,EAAE,KADI;AAETT,QAAAA,OAAO,EAAE;AAFA,OANJ;AAUTI,MAAAA,WAAW,EAAE;AAVJ,KAAb;AAaA,SAAKM,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAAzB;AACA,SAAKhB,IAAL,GAAY,KAAKA,IAAL,CAAUgB,IAAV,CAAe,IAAf,CAAZ;AACA,SAAKC,EAAL,GAAU,KAAKA,EAAL,CAAQD,IAAR,CAAa,IAAb,CAAV;AACA,SAAKE,aAAL,GAAqB,KAAKA,aAAL,CAAmBF,IAAnB,CAAwB,IAAxB,CAArB;AACH;;AAED,QAAMD,iBAAN,GAA2B;AACvB7B,IAAAA,MAAM,CAAC0B,IAAP,CAAY,cAAZ;AAEAR,IAAAA,MAAM,CAACe,gBAAP,CAAwB,UAAxB,EAAoCC,CAAC,IAAI;AACrCA,MAAAA,CAAC,CAACC,cAAF;AACA,WAAKrB,IAAL,CAAUoB,CAAV;AACH,KAHD;AAKAlC,IAAAA,MAAM,CAACoC,SAAP,CAAiB,OAAO;AAAEC,MAAAA,MAAM,EAAE;AAAEC,QAAAA,IAAF;AAAQC,QAAAA;AAAR;AAAV,KAAP,KAAqC;AAClD,UAAID,IAAI,KAAKE,SAAb,EAAwBC,OAAO,CAACC,GAAR,CAAYJ,IAAZ,EAAkBC,IAAlB;;AACxB,UAAID,IAAI,KAAK,sBAAb,EAAqC;AACjC,cAAMK,eAAe,GAAGC,QAAQ,CAACC,eAAT,CAAyB,QAAzB,CAAxB;AACAF,QAAAA,eAAe,CAACG,KAAhB,GAAwBP,IAAI,CAACQ,MAAL,GAAcR,IAAI,CAACQ,MAAnB,GAA4B,cAApD;AACAH,QAAAA,QAAQ,CAACI,IAAT,CAAcC,UAAd,CAAyBC,YAAzB,CAAsCP,eAAtC;AACH;AACJ,KAPD;AAQH;;AAkBDZ,EAAAA,EAAE,CAACoB,KAAD,EAAQ;AAAA,uBACyB,KAAKpC,KAD9B;AAAA,QACAQ,WADA,gBACAA,WADA;AAAA,QACaJ,OADb,gBACaA,OADb;AAEN,QAAIK,QAAQ,GAAGL,OAAO,CAACI,WAAD,CAAtB;;AACA,QAAGC,QAAQ,CAACA,QAAQ,CAACC,MAAT,GAAgB,CAAjB,CAAR,KAAgC0B,KAAnC,EAA0C;AACtC3B,MAAAA,QAAQ,CAAC4B,IAAT,CAAcD,KAAd;AACAjC,MAAAA,MAAM,CAACC,OAAP,CAAeC,SAAf,CAAyB;AAAEE,QAAAA,WAAW,EAAE6B;AAAf,OAAzB,EAAiD,OAAjD;AACA,WAAKlC,QAAL,CAAc;AAAEK,QAAAA,WAAW,EAAE6B,KAAf;AAAsBhC,QAAAA;AAAtB,OAAd;AACH;AACJ;;AAEDa,EAAAA,aAAa,CAAEE,CAAF,EAAK;AACd,SAAKjB,QAAL,CAAc;AAAEM,MAAAA,WAAW,EAAEW,CAAC,CAACmB,aAAF,CAAgBC,OAAhB,CAAwBC;AAAvC,KAAd;AACH;;AAEDC,EAAAA,MAAM,GAAG;AACL,WACI,oBAAC,IAAD;AAAM,MAAA,WAAW,EAAE,KAAKzC,KAAL,CAAWQ,WAA9B;AAA2C,MAAA,MAAM,EAC7C,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,UAAD;AACI,QAAA,OAAO,EAAE,KAAKS,aADlB;AAEI,QAAA,QAAQ,EAAE,KAAKjB,KAAL,CAAWQ,WAAX,KAA2B,KAFzC;AAGI,sBAAW,KAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIC,oBAAC,WAAD;AAAa,QAAA,MAAM,EAAE,KAAKR,KAAL,CAAWQ,WAAX,KAA2B,KAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJD,CADJ,EAMI,oBAAC,UAAD;AACI,QAAA,OAAO,EAAE,KAAKS,aADlB;AAEI,QAAA,QAAQ,EAAE,KAAKjB,KAAL,CAAWQ,WAAX,KAA2B,SAFzC;AAGI,sBAAW,SAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIC,oBAAC,WAAD;AAAa,QAAA,MAAM,EAAE,KAAKR,KAAL,CAAWQ,WAAX,KAA2B,SAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJD,CANJ,CADJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAcI,oBAAC,IAAD;AAAM,MAAA,EAAE,EAAC,KAAT;AAAe,MAAA,WAAW,EAAE,KAAKR,KAAL,CAAWO,WAAX,CAAuBM,GAAnD;AAAwD,MAAA,MAAM,EAAE,KAAKb,KAAL,CAAWC,MAA3E;AAAmF,MAAA,OAAO,EAAE,KAAKD,KAAL,CAAWI,OAAX,CAAmBS,GAA/G;AAAoH,MAAA,WAAW,EAAE,KAAKd,IAAtI;AAA4I,MAAA,SAAS,EAAE,KAAvJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,EAAE,EAAC,KAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kFADJ,CADJ,CAdJ,EAmBI,oBAAC,IAAD;AAAM,MAAA,EAAE,EAAC,SAAT;AAAmB,MAAA,WAAW,EAAE,KAAKC,KAAL,CAAWO,WAAX,CAAuBH,OAAvD;AAAgE,MAAA,MAAM,EAAE,KAAKJ,KAAL,CAAWC,MAAnF;AAA2F,MAAA,OAAO,EAAE,KAAKD,KAAL,CAAWI,OAAX,CAAmBA,OAAvH;AAAgI,MAAA,WAAW,EAAE,KAAKL,IAAlJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,EAAE,EAAC,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oDADJ,CADJ,CAnBJ,CADJ;AA4BH;;AArGiC;;AAwGtC,eAAeJ,OAAf","sourcesContent":["import React from 'react';\r\nimport bridge from '@vkontakte/vk-bridge';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport './css/Tracker.css';\r\n\r\nimport { Panel, PanelHeader, View, Epic, Tabbar, TabbarItem, Div } from '@vkontakte/vkui';\r\n\r\nimport Icon28Truck from './icons/Icon28Truck.js';\r\nimport Icon28Clock from './icons/Icon28Clock.js';\r\n\r\nclass Tracker extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            popout: null,\r\n            history: {\r\n                add: [ 'add' ],\r\n                history: [ 'history' ]\r\n            },\r\n            activePanel: {\r\n                add: 'add',\r\n                history: 'history'\r\n            },\r\n            activeStory: 'add'\r\n        };\r\n\r\n        this.componentDidMount = this.componentDidMount.bind(this);\r\n        this.back = this.back.bind(this);\r\n        this.go = this.go.bind(this);\r\n        this.onStoryChange = this.onStoryChange.bind(this);\r\n    }\r\n\r\n    async componentDidMount () {\r\n        bridge.send('VKWebAppInit');\r\n\r\n        window.addEventListener('popstate', e => {\r\n            e.preventDefault();\r\n            this.back(e);\r\n        });\r\n\r\n        bridge.subscribe(async ({ detail: { type, data }}) => {\r\n            if (type !== undefined) console.log(type, data);\r\n            if (type === 'VKWebAppUpdateConfig') {\r\n                const schemeAttribute = document.createAttribute('scheme');\r\n                schemeAttribute.value = data.scheme ? data.scheme : 'bright_light';\r\n                document.body.attributes.setNamedItem(schemeAttribute);\r\n            }\r\n        });\r\n    }\r\n\r\n    back = () => {\r\n        if(this.state.popout !== null){\r\n            this.setState({ popout: null });\r\n            window.history.pushState({ pop: 'popout' }, 'Title');\r\n            return ;\r\n        }\r\n        let { activePanel, activeStory, history } = this.state;\r\n        let history_ = history[activeStory];\r\n        if(history_.length === 1) {\r\n            bridge.send('VKWebAppClose', { status: 'success' });\r\n        } else if (history_.length > 1) {\r\n            history_.pop();\r\n            activePanel = history_[history_.length - 1];\r\n            this.setState({ activePanel, history });\r\n        }\r\n    };\r\n    go(panel) {\r\n        let { activeStory, history } = this.state;\r\n        let history_ = history[activeStory];\r\n        if(history_[history_.length-1] !== panel) {\r\n            history_.push(panel);\r\n            window.history.pushState({ activePanel: panel }, 'Title');\r\n            this.setState({ activePanel: panel, history });\r\n        }\r\n    }\r\n\r\n    onStoryChange (e) {\r\n        this.setState({ activeStory: e.currentTarget.dataset.story })\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Epic activeStory={this.state.activeStory} tabbar={\r\n                <Tabbar>\r\n                    <TabbarItem\r\n                        onClick={this.onStoryChange}\r\n                        selected={this.state.activeStory === 'add'}\r\n                        data-story='add'\r\n                    ><Icon28Truck active={this.state.activeStory === 'add'}/></TabbarItem>\r\n                    <TabbarItem\r\n                        onClick={this.onStoryChange}\r\n                        selected={this.state.activeStory === 'history'}\r\n                        data-story='history'\r\n                    ><Icon28Clock active={this.state.activeStory === 'history'}/></TabbarItem>\r\n                </Tabbar>\r\n            }>\r\n                <View id='add' activePanel={this.state.activePanel.add} popout={this.state.popout} history={this.state.history.add} onSwipeBack={this.back} separator={false}>\r\n                    <Panel id='add'>\r\n                        <PanelHeader>Отслеживание</PanelHeader>\r\n                    </Panel>\r\n                </View>\r\n                <View id='history' activePanel={this.state.activePanel.history} popout={this.state.popout} history={this.state.history.history} onSwipeBack={this.back}>\r\n                    <Panel id='history'>\r\n                        <PanelHeader>История</PanelHeader>\r\n                    </Panel>\r\n                </View>\r\n            </Epic>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nexport default Tracker;"]},"metadata":{},"sourceType":"module"}